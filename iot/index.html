<button id="ble">OK OK OK OK</button>

<script>
	var device, remoteService, joystickCharacteristic;

	var dataview;

	document.getElementById('ble').addEventListener('click', async () => {
		device = await navigator.bluetooth.requestDevice({
			filters: [
				{
					name: 'Raspberry Pi'
				}
			],
			optionalServices: ['0000fff0-0000-1000-8000-00805f9b34fb']
		});

		await device.gatt.connect();

		remoteService = await device.gatt.getPrimaryService('0000fff0-0000-1000-8000-00805f9b34fb');

		console.log(remoteService);
		
		joystickCharacteristic = await remoteService.getCharacteristic('0000fff1-0000-1000-8000-00805f9b34fb');

		console.log(joystickCharacteristic);

		await joystickCharacteristic.startNotifications();
		
		joystickCharacteristic.oncharacteristicvaluechanged = (e) => {
			dataview = joystickCharacteristic.value;
			
			const decoder = new TextDecoder();

			const action = decoder.decode(dataview);

			speechSynthesis.speak(new SpeechSynthesisUtterance(action));
		};
	});
</script>